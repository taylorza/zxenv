        SLDOPT COMMENT WPMEM, LOGPOINT, ASSERTION
        DEVICE ZXSPECTRUMNEXT
        CSPECTMAP "{{.Name}}.map"
{{if (eq .Type "NEX")}}
        org  $8000
{{else if (eq .Type "DOT")}}
        org  $2000
{{end}}
main:
        ld   a,4        ; Set A to green
        out  ($fe),a    ; Change the border
{{if (eq .Type "NEX")}}
        jr   $          ; Loop forever!
{{else}}
        ret
{{end}}

{{if (eq .Type "NEX")}}
;------------------------------------------------------------------------------
; Stack reservation
STACK_SIZE      equ     100

stack_bottom:
        defs    STACK_SIZE * 2
stack_top:
        defw    0

;------------------------------------------------------------------------------
; Output configuration
        SAVENEX OPEN "{{.Name}}.nex", main, stack_top 
        SAVENEX CORE 2,0,0
        SAVENEX CFG 7,0,0,0
        SAVENEX AUTO 
        SAVENEX CLOSE
{{else if (eq .Type "DOT")}}
code_size   equ $
;------------------------------------------------------------------------------
; Output configuration
    SAVEBIN "{{.Name}}", main, code_size
{{end}}